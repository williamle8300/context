/**
 * Vanilla JS
 */

var topics = {};
var subscribe = function(name, fn) {
  topics[name] = topics[name] || [];
  topics[name].push(fn);
}
var publish = function(name, args) {
  topics[name] = topics[name] || [];
  topics[name].forEach(function(fn) {
    fn.apply(this, args);
  });
}
 
subscribe('download_started', function(total_kb) {
  console.log('will download an extra', total_kb);
});
subscribe('download_started', function(total_kb) {
  console.log('0/', total_kb);
});
publish('download_started', [1024]);

console.log('%O', topics);



/**
 * NODE/BROWSERIFY Little blinking lights
 */

//modA.js
var events = require('events');
var emitter = new events.EventEmitter;

function funcA() {
  console.log('mod@.funcA executing');
  emitter.emit('funcA');
}

module.exports = {
  funcA: funcA,
  emitter: emitter
};
//modB.js
var events = require('events');
var emitter = new events.EventEmitter;

function funcB() {
  console.log('modB.funcB executing');
  emitter.emit('funcB');
}

module.exports = {
  funcB: funcB,
  emitter: emitter
};

//glue.js
var modA = require('./modA');
var modB = require('./modB');
modA.emitter.on('funcA', modB.funcB);
modA.funcA();
